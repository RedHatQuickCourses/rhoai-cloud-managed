= Amazon SageMaker

== Objectives

 * Understanding Amazon SageMaker
 * Get Hands-on with Amazon SageMaker QuickStart

== What is Amazon SageMaker? 

Amazon SageMaker is a fully managed service that brings together a broad set of tools to enable high-performance, low-cost machine learning (ML) for any use case. With SageMaker, you can build, train and deploy ML models at scale using tools like notebooks, debuggers, profilers, pipelines, MLOps, and more all in one integrated development environment (IDE). 

SageMaker supports governance requirements with simplified access control and transparency over your ML projects. In addition, you can build your own Foundation Models (FMs), large models that were trained on massive datasets, with purpose-built tools to fine-tune, experiment, retrain, and deploy FMs. 

Amazon SageMaker empowers Data Scientists, Developers, and Business Data Analysts regardless of their ML expertise to build, train, and deploy machine learning (ML) models for any use case with fully managed infrastructure, tools, and workflows.

'''

 * Building models – You can create ML models seamlessly and prepare them for training. SageMaker has tools that allow you to connect to your training data and select and optimize the appropriate algorithms for the application. You don’t have to struggle to choose your preferred algorithm because the service has a list of some of the most popular and commonly used ML algorithms.
 * Training models – With SageMaker, you can train your models easily and quickly. The service has the necessary infrastructure to train and to scale.
 * Deploying models – After building and training your models, it is time to deploy them. SageMaker helps you implement ML models swiftly and with ease. You can start generating predictions on fresh data and those predictions are available to any production platform via an accessible API.


image::ml-concepts-10.png[width=480]



//SageMaker offers access to hundreds of pretrained models, including publicly available FMs, that you can deploy with just a few clicks.

=== SageMaker Studio 

image::aws_sagemaker_open.gif[width=600]

SageMaker Studio is the dashboard product used to interact with this cloud service and access machine learning models from a variety of model providers. It provides a unified, web-based interface to manage your data, code and models in a single place. SageMaker Studio also provides easy scalability and reliable security. 

==== SageMaker Features

In SageMaker, a notebook is a web-based interface that allows data scientists and developers to create and share documents that contain code, visualizations and narrative text. They provide a secure and collaborative environment for ML projects, allowing users to easily track changes while keeping their data and code organized. 

SageMaker comes with several preloaded algorithms and solution templates for supervised and unsupervised learning.. The platform also provides access to popular deep learning frameworks like TensorFlow, MXNet and PyTorch. 

Keep track of models over time with SageMaker’s Model Monitor feature. This allows for continuous monitoring and reporting with a real-time endpoint. The Model Monitor feature integrates with Amazon SageMaker Clarify to detect any bias that emerges.

The platform integrates with popular DevOps tools, like AWS CodePipe and Jenkins, through the SageMaker console, APIs or other methods. This allows businesses to create continuous integration and continuous deployment (CI/CD) pipelines for continuous delivery of ML models. 

SageMaker Studio has several automation tools to accelerate the ML process and provide greater visibility and control over the various steps required to build production-ready models. These are just some of the available tools:

 * AWS Autopilot automatically builds and trains ML models while providing you with complete visibility into model creation.
 * Data Wrangler is a quick way to prepare data. It has many common data cleaning techniques that can reduce the time for data cleansing from weeks to minutes.
 * Debugger monitors your models for bottlenecks.
 * Edge Manager extends ML monitoring to edge devices.
 * Ground Truth accelerates data labeling and lets you create high-quality training samples.
 * Model Monitor monitors ML models and notifies you when it detects deviations.
 * Pipelines automate ML workflows, enabling you to scale ML across your organization.
 * SageMaker Project is an AWS Service Catalog provisioned product used to create end-to-end ML solutions.

image::sagemaker_overviewv2.gif[width=600]

=== How much does SageMaker cost ?

Like many AWS products, SageMaker charges you for what you use, without minimum and upfront commitments. You incur costs for building, training, and deploying ML models by the second. You pay for the ML compute, storage, instances, and data processing resources you utilize.

For specific pricing information depending on instance size and tasks, visit the https://aws.amazon.com/sagemaker/pricing/[Amazon SageMaker pricing dashboard, window=blank]

== Summary:

Amazon SageMaker is a fully managed machine learning service. With Amazon SageMaker, data scientists and developers can quickly build and train machine learning models, and then deploy them into a production-ready hosted environment.

It reduces the complexity of model development by providing a web-based interface for creating ML pipelines and pre-built algorithms. These integrations provide a streamlined, standard process for packaging and deploying ML models, helping MLOps teams produce models faster and with fewer errors. 

Amazon SageMaker uses domains to organize user profiles, applications, and their associated resources.
 
SageMaker includes all of the tools you need to take your models from data preparation to experimentation to production with increased productivity. In a single visual interface, you can do the following tasks:

 * Write and run code in Jupyter notebooks
 * Prepare data for machine learning
 * Build and train ML models
 * Deploy the models and monitor the performance of their predictions
 * Track and debug ML experiments
 * Collaborate with other users in real time

With Amazon SageMaker, data scientists and developers can quickly build and train machine learning models, and then deploy them into a production-ready hosted environment.


== Lab Exercise:  Get Started with Amazon SageMaker


=== Demo Platform Lab Environment

Launch an AWS Blank Open Environment to follow along with this guided lab.

https://demo.redhat.com/catalog?search=AWS+Blank+Open+Environment&item=babylon-catalog-prod%2Fsandboxes-gpte.sandbox-open.prod[AWS Blank Open Environment, window=blank]

This lab environment can take up to 20 minutes to become available, however it's usually available in a few minutes. 

=== Logon to the AWS Console and open SageMaker

image::aws_sagemaker_open.gif[width=600]

 . Use the link and credentials provided by Demo Hub to logon to the AWS Console.
 . Use the search bar to search for *sagemaker*.
 . Under service click the *Amazon SageMaker* tile to open Amazon SageMaker.
 . Explore the SageMaker home page.


'''

=== Create a SageMaker domain

 . Select the SageMaker Studio menu option
 . Select the Create a SageMaker domain option
 . Choose the Set up for single user (Quick setup) option on the left.
 . Click on the Set up button. 

At which point an error message will appear:  There is no VPC with available Subnets in this region.  Please Create one. 

image::sagemaker_vpc_error.gif[width=600]

====  Create a VPC to continue

 . Select the *Create VPC* option in the error message.
 . At top right, select *Create VPC*.
 . Enter the option name tag: *sagemaker_domain_demo*
 . For IPv4 CIDR enter:  *172.17.0.0/16*
 . Scroll to the bottom and select *Create VPC*.
 
image::sagemaker_vpc_createv2.gif[width=600]

==== Create a Subnet in the VPC

 . Under the Virtual privage cloud menu, *select Subnets*
 . At top right, select *Create subnet*.
 . Select a VPC ID from the dropdown, use the name if multiple vpc's exist (sagemaker_domain_demo).
 . In the Subnet Settings, enter a Subnet name: *sagemaker-demo-subnet*.
 . For IPv4 subnet CIDR block enter:  *172.17.0.1/24*
 . Scroll to the bottom and select *Create subnet*.

image::sagemaker_vpc_subnetv2.gif[width=600]

==== Create a Subnet in the VPC

 . Return the SageMaker Domain setup page
 . Select the *Set up* options again.
 . You'll recieve an Preparing SageMaker Domain Banner across the page
 .. The domain setup takes ~5-7 minutes.
 . Once the setup completes the blue banner will disappears and the status will change to ready.
 . Use the *Amazon SageMaker* link to return to the Sagemaker dashboard.
 . Select the *Studio* link to refresh the dashboard.
 . From the *Get Started* box select *Open Studio*.

You are now ready to use SageMaker Studio

image::sagemaker_setupv2.gif[width=600]

'''

=== Explore Amazone SageMaker for your use case

Explore the *SageMaker Tour*, onboarding plan, and  *getting started* areas to learn more about SageMaker. 

image::sagemaker_tourv2.gif[width=600]

== Summary

In this quick take on Amazon SageMaker we setup a SageMaker domain which can be complex if your new to AWS.








