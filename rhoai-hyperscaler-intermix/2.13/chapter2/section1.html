<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Section 1 :: Generative AI across HyperScalers with OpenShift AI</title>
    <link rel="prev" href="index.html">
    <link rel="next" href="section2.html">
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://www.redhat.com" target="_blank"><img src="../../../_/img/redhat-logo.png" height="40px" alt="Red Hat"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="../../..">Generative AI across HyperScalers with OpenShift AI</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://github.com/RedHatQuickCourses/REPLACEREPONAME/issues" target="_blank">Report Issues</a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="rhoai-hyperscaler-intermix" data-version="2.13">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Generative AI across HyperScalers with OpenShift AI</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Home</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../LABENV/index.html">Lab Env RHOAI self-managed</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../LABENV/red-hat-docs.html">Red Hat Documentation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../LABENV/openshiftai-install.html">Dashboard RHOAI Creation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../LABENV/hyperscaler_lab_env.html">Cloud Provider Lab Environments</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../chapter1/index.html">MultiCloud OpenShift</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter1/section4.html">OpenShift and OpenShift AI</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="index.html">Red Hat OpenShift on AWS  (ROSA)</a>
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="section1.html">Section 1</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="section2.html">OpenShift (AI) on AWS</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="section3.html">AWS AI Services</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../chapter3/index.html">Microsoft Azure Red Hat OpenShift (ARO)</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter3/section1.html">Section 1</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter3/section2.html">Section 2</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter3/section3.html">Azure AI Services</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../appendix/appendix.html">Appendix</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appendix/section1.html">General questions</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Generative AI across HyperScalers with OpenShift AI</span>
    <span class="version">2.13</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">Generative AI across HyperScalers with OpenShift AI</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">2.13</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Generative AI across HyperScalers with OpenShift AI</a></li>
    <li><a href="index.html">Red Hat OpenShift on AWS  (ROSA)</a></li>
    <li><a href="section1.html">Section 1</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Section 1</h1>
<div id="preamble">
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Create multiple copies of this section as needed.</p>
</li>
<li>
<p>Remove any unnecessary sections or chapter pages.</p>
</li>
<li>
<p>Customize the section as appropriate.</p>
</li>
<li>
<p>Ensure that each page contains a manageable amount of content.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_section_1"><a class="anchor" href="#_section_1"></a>Section 1</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_aws_marketplace_product_overview_red_hat_openshift_ai"><a class="anchor" href="#_aws_marketplace_product_overview_red_hat_openshift_ai"></a>AWS MarketPlace Product Overview - Red Hat OpenShift AI</h3>
<div class="paragraph">
<p>Red Hat OpenShift AI enables companies to solve critical business challenges by providing a fully managed cloud service environment on Red Hat OpenShift Service on AWS. Red Hat OpenShift AI allows organizations to quickly build and deploy artificial intelligence (AI)/ML models by integrating open-source applications with commercial partner technology.</p>
</div>
<div class="paragraph">
<p>Red Hat OpenShift AI is an easy-to-configure cloud service that provides a powerful platform for building AI/ML models and applications. It combines the self-service data scientists and developers want with the confidence enterprise IT demands into one common platform. Common tooling, such as Jupyter notebooks and associated TensorFlow and Pytorch frameworks, are an add-on to Red Hat OpenShift Service on AWS, an application platform cloud service powered by Kubernetes and co-managed by Red Hat and Amazon.</p>
</div>
<div class="paragraph">
<p>Classic or HCP (hosted control planes) ROSA cluster.
Classic: I ran this tutorial on a classic single-AZ ROSA 4.15.17 cluster with m6a.4xlarge node with auto-scaling enabled up to 10 nodes. The cluster has 80 vCPUs with ~339Gi memory.
HCP: I also ran this tutorial on an HCP ROSA 4.16.3 cluster with m5.xlarge node with 28 vCPUs and ~108Gi memory.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>rosa create machinepool --cluster=&lt;your-cluster-name&gt; --name=gpu-pool --instance-type=g5.4xlarge --min-replicas=1 --max-replicas=4 --enable-autoscaling --labels='gpu-node=true' --taints='nvidia.com/gpu=present:NoSchedule'</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_deploy_and_llm_on_rosa_with_hcp"><a class="anchor" href="#_deploy_and_llm_on_rosa_with_hcp"></a>Deploy and LLM on ROSA with HCP</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Learn how to install the Red Hat® OpenShift® AI (RHOAI) operator and Jupyter notebook, create an Amazon S3 bucket, and run the LLM model on a Red Hat OpenShift Service on AWS (ROSA) cluster. <a href="https://cloud.redhat.com/learn/how-run-and-deploy-llms-using-red-hat-openshift-ai-red-hat-openshift-service-aws-cluster" target="blank">LINK</a></p>
</div>
<div class="paragraph">
<p><a href="https://console.redhat.com/openshift/create">Link to the Hybrid Cloud Console</a></p>
</div>
<div class="sect2">
<h3 id="_rosa_cluster_deployment_cli"><a class="anchor" href="#_rosa_cluster_deployment_cli"></a>Rosa Cluster Deployment - CLI</h3>
<div class="paragraph">
<p>Deploy ROSA cluster
set some environment variables</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Copy
 export ROSA_CLUSTER_NAME=mycluster
 export AWS_ACCOUNT_ID=`aws sts get-caller-identity \
   --query Account --output text`
 export REGION=us-east-2
 export AWS_PAGER=""</pre>
</div>
</div>
<div class="paragraph">
<p>Make you your ROSA CLI version is correct (v1.2.25 or higher)</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Copy
 rosa version</pre>
</div>
</div>
<div class="paragraph">
<p>Run the rosa cli to create your cluster</p>
</div>
<div class="paragraph">
<p>Note there are many configurable installation options that you can view using rosa create cluster -h. The following will create a cluster with all of the default options.</p>
</div>
<div class="paragraph">
<p>Copy
 rosa create cluster --sts --cluster-name ${ROSA_CLUSTER_NAME} \
   --region ${REGION} --mode auto --yes</p>
</div>
<div class="paragraph">
<p>Watch the install logs</p>
</div>
<div class="paragraph">
<p>Copy
 rosa logs install -c $ROSA_CLUSTER_NAME --watch --tail 10</p>
</div>
<div class="paragraph">
<p>Validate the cluster
Once the cluster has finished installing we can validate we can access it</p>
</div>
<div class="paragraph">
<p>Create an Admin user</p>
</div>
<div class="paragraph">
<p>Copy
 rosa create admin -c $ROSA_CLUSTER_NAME</p>
</div>
<div class="paragraph">
<p>Wait a few moments and run the oc login command it provides. If it fails, or if you get a warning about TLS certificates, wait a few minutes and try again.</p>
</div>
<div class="paragraph">
<p>Run oc whoami --show-console, browse to the provided URL and log in using the credentials provided above.</p>
</div>
<div class="paragraph">
<p>Cleanup
 Delete the ROSA cluster</p>
</div>
<div class="literalblock">
<div class="content">
<pre>rosa delete cluster -c $ROSA_CLUSTER_NAME
Clean up the STS roles</pre>
</div>
</div>
<div class="paragraph">
<p>Once the cluster has been deleted we can delete the STS roles.</p>
</div>
<div class="paragraph">
<p>Tip You can get the correct commands with the ID filled in from the output of the previous step.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>rosa delete operator-roles -c &lt;id&gt; --yes --mode auto
rosa delete oidc-provider -c &lt;id&gt;  --yes --mode auto</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>=== Install OpenShift AI</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>From your cluster console, go to OperatorHub under Operators from the left tab, and put “Red Hat OpenShift AI” into the search query to install the operator. Note: The most recent version of the operator at the time of writing is 2.13.0.</pre>
</div>
</div>
<div class="paragraph">
<p>Choose the default option for the installation. The operator will be installed in the redhat-ods-operator namespace, which will be created automatically upon installation.</p>
</div>
<div class="paragraph">
<p>Afterward, create a DataScienceCluster (DSC) instance. Once again, choose the default option for the installation. The name of the DSC instance will be default-dsc.</p>
</div>
</div>
<div class="sect2">
<h3 id="_creating_and_granting_access_to_amazon_s3_bucket"><a class="anchor" href="#_creating_and_granting_access_to_amazon_s3_bucket"></a>Creating and granting access to Amazon S3 bucket</h3>
<div class="paragraph">
<p>There are actually several ways to go about granting S3 access to the pods running in your Red Hat® OpenShift® Service on AWS (ROSA) cluster. For example, you can set the credentials as environment variables in the notebook using pod identity/Identity Access Management (IAM) Roles for Service Accounts (IRSA) to authenticate the pods to S3. Or, you can install the AWS command line interface (CLI) in the cluster, among others.</p>
</div>
<div class="paragraph">
<p>For the sake of simplicity, we’ll install the CLI in the cluster and then use the command aws configure to provide the credentials. Be sure that you have your AWS access key and secret access key handy. You could create new keys in the IAM section from the AWS console if you have lost yours.</p>
</div>
<div class="paragraph">
<p>SS CLI TO POD</p>
</div>
<div class="paragraph">
<p>Now log into your cluster and go to the namespace where your notebook is located:
 oc project rhods-notebooks
Run the following command and make sure that your pods are running: oc get pods</p>
</div>
<div class="paragraph">
<p>Once you have the name of the pod (in this case it is called jupyter-nb-admin-0), execute into it:
 oc exec -it jupyter-nb-admin-0&#8201;&#8212;&#8201;/bin/bash</p>
</div>
<div class="paragraph">
<p>Next, let&#8217;s install the AWS CLI in that pod:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>curl "https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip" -o "awscliv2.zip"
unzip awscliv2.zip
./aws/install -i ~/.local/aws-cli -b ~/.local/bin</pre>
</div>
</div>
<div class="paragraph">
<p>Then modify your PATH environment:
 export PATH=~/.local/bin:$PATH</p>
</div>
<div class="paragraph">
<p>Once it is correctly installed, be sure that you have your AWS Access Key ID and AWS Secret Access Key ready, and run the following command: aws configure
Select the region where your cluster is located. You could verify the configuration by running simple command such as listing the S3 buckets:
 aws s3 ls</p>
</div>
<div class="paragraph">
<p>Once the credentials matter is sorted, let&#8217;s create an S3 bucket in your AWS account. Again, there are many ways to go about this. The easiest would be to go to your AWS console and create the bucket in your region from there and leave all the settings to default.</p>
</div>
<div class="paragraph">
<p>Alternatively, you can run this command to create a bucket (in this case, it’s called llm-bucket-dsari, and the cluster region is us-west-2):
  aws s3 mb s3://llm-bucket-dsari --region us-west-2</p>
</div>
<div class="paragraph">
<p>Once these steps are complete, you’re ready to begin training the LLM model in the next resource.</p>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="index.html">Red Hat OpenShift on AWS  (ROSA)</a></span>
  <span class="next"><a href="section2.html">OpenShift (AI) on AWS</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <img src="../../../_/img/rhl-logo-red.png" height="40px" alt="Red Hat"  href="https://redhat.com" >
</footer><script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
